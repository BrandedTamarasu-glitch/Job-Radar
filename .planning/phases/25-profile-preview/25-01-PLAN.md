---
phase: 25-profile-preview
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - job_radar/profile_display.py
  - pyproject.toml
autonomous: true

must_haves:
  truths:
    - "display_profile() prints a bordered table with section headers showing only non-empty profile fields"
    - "List fields render as comma-separated inline (no truncation)"
    - "Boolean fields show 'Yes'/'No', numeric fields show just the value"
    - "Branded header line '... Job Radar Profile ...' appears above the table"
    - "Output respects NO_COLOR by using existing _Colors class"
  artifacts:
    - path: "job_radar/profile_display.py"
      provides: "display_profile function for formatted profile output"
      contains: "def display_profile"
    - path: "pyproject.toml"
      provides: "tabulate dependency declaration"
      contains: "tabulate"
  key_links:
    - from: "job_radar/profile_display.py"
      to: "job_radar/search.py"
      via: "imports _Colors class"
      pattern: "from .search import _Colors"
    - from: "job_radar/profile_display.py"
      to: "tabulate"
      via: "library import"
      pattern: "from tabulate import tabulate"
---

<objective>
Create the profile_display.py module that formats and prints a bordered, sectioned profile preview using tabulate, and add tabulate as a project dependency.

Purpose: This is the display layer for Phase 25 -- a standalone module that takes profile and config dicts and prints a formatted table. Separated from integration (Plan 02) to keep each plan focused.

Output: job_radar/profile_display.py with display_profile() function, tabulate added to pyproject.toml
</objective>

<execution_context>
@/home/corye/.claude/get-shit-done/workflows/execute-plan.md
@/home/corye/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-profile-preview/25-RESEARCH.md
@.planning/phases/24-profile-infrastructure/24-02-SUMMARY.md
@job_radar/search.py (lines 45-84 for _Colors class)
@job_radar/profile_manager.py (for profile dict structure and validation)
@job_radar/config.py (for config dict structure -- min_score, new_only)
@profiles/_template.json (complete field list)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add tabulate dependency to pyproject.toml</name>
  <files>pyproject.toml</files>
  <action>
Add `tabulate>=0.9.0` to the `dependencies` list in pyproject.toml. Place it alphabetically among the existing dependencies.

After adding, run `pip install -e .` to verify it installs correctly.

Note: tabulate 0.9.0 is pure Python, ~50KB, already chosen during milestone research. No PyInstaller hook changes needed.
  </action>
  <verify>Run `python -c "from tabulate import tabulate; print(tabulate([['test', 'ok']], tablefmt='simple_grid'))"` and confirm it prints a bordered table.</verify>
  <done>tabulate>=0.9.0 appears in pyproject.toml dependencies and imports successfully.</done>
</task>

<task type="auto">
  <name>Task 2: Create profile_display.py with display_profile() function</name>
  <files>job_radar/profile_display.py</files>
  <action>
Create `job_radar/profile_display.py` with a single public function:

```python
def display_profile(profile: dict, config: dict | None = None) -> None:
```

**Implementation details per locked user decisions:**

1. **Branded header** -- Print a centered "Job Radar Profile" line with `═` border characters using `C.CYAN` color:
   ```
   ═══════════════════ Job Radar Profile ═══════════════════
   ```

2. **Sectioned table with headers** -- Group fields into 4 sections. Use section header rows with `C.BOLD` styling. Sections:
   - **IDENTITY**: name, years_experience (with level suffix if set), location, arrangement
   - **SKILLS**: core_skills, secondary_skills, certifications, domain_expertise
   - **PREFERENCES** (from config dict): min_score, new_only
   - **FILTERS**: dealbreakers, comp_floor, target_titles

3. **Only show set fields** -- For each field, only add a row if the value is truthy:
   - String fields: skip if None or empty string
   - List fields: skip if None or empty list
   - Numeric fields: skip if None (but 0 is valid -- use `is not None` check)
   - Boolean fields: always show if config is provided (new_only has a meaningful default)
   - Skip entire section if ALL fields in that section are empty

4. **Field presentation per user decisions:**
   - List fields → `", ".join(items)` (comma-separated inline, show ALL items, no truncation)
   - Numeric fields → just the value (e.g., "3.5" not "3.5 (0.0-5.0)")
   - Boolean fields → "Yes" / "No" (not True/False)
   - years_experience → `"7 years (senior level)"` if level set, else `"7 years"`
   - comp_floor → `"$120,000"` format with comma separator
   - arrangement → comma-separated (e.g., "remote, hybrid")

5. **Bordered table** -- Use tabulate with `tablefmt="simple_grid"` and `colalign=("left", "left")`. Two columns: field label and value.

6. **Color via existing _Colors class** -- Import `from .search import _Colors as C`. Use:
   - `C.CYAN` for branded header
   - `C.BOLD` for section headers
   - `C.DIM` for separator line
   - `C.RESET` after each colored element

7. **Separator line** after table -- Print `─` * 60 in DIM color to separate profile from search output.

8. **No section headers in tabulate** -- Instead of embedding section headers in tabulate rows (which adds borders around them), print each section as a separate small table with a printed section label above it. OR: Use section headers as rows with empty second column but bold styling. Claude's discretion on exact approach -- the key requirement is readable sections with borders.

**Do NOT:**
- Create new color infrastructure (reuse _Colors from search.py)
- Truncate any list fields
- Show empty/None fields
- Display range hints on numeric fields
- Add a separate --no-preview flag (--no-wizard handles suppression)
  </action>
  <verify>
Create a small test script and run it:
```python
python -c "
from job_radar.profile_display import display_profile
profile = {
    'name': 'Test User', 'years_experience': 7, 'level': 'senior',
    'target_titles': ['Software Engineer', 'Backend Dev'],
    'core_skills': ['Python', 'PostgreSQL', 'Docker'],
    'location': 'Remote', 'arrangement': ['remote', 'hybrid'],
    'dealbreakers': ['PHP', 'Java'],
}
config = {'min_score': 3.5, 'new_only': True}
display_profile(profile, config)
"
```
Verify: branded header appears, sections visible, only set fields shown, lists are comma-separated, bordered table renders.

Also test with NO_COLOR=1:
```bash
NO_COLOR=1 python -c "from job_radar.profile_display import display_profile; display_profile({'name': 'X', 'target_titles': ['A'], 'core_skills': ['B']}, {})"
```
Verify: no ANSI escape codes in output.
  </verify>
  <done>
profile_display.py exists with display_profile() that:
- Prints branded header with "Job Radar Profile"
- Shows profile fields in sectioned, bordered table
- Filters out None/empty fields
- Lists are comma-separated (no truncation)
- Booleans show Yes/No
- Respects NO_COLOR via _Colors class
- Prints separator line after table
  </done>
</task>

</tasks>

<verification>
1. `python -c "from tabulate import tabulate; print('ok')"` succeeds
2. `python -c "from job_radar.profile_display import display_profile; display_profile({'name': 'Test', 'target_titles': ['Dev'], 'core_skills': ['Python']}, {'min_score': 3.0, 'new_only': False})"` prints formatted profile
3. Empty fields are NOT shown: `python -c "from job_radar.profile_display import display_profile; display_profile({'name': 'Test', 'target_titles': ['Dev'], 'core_skills': ['Python'], 'dealbreakers': [], 'comp_floor': None}, {})"` -- no dealbreakers or comp_floor rows
4. Existing test suite still passes: `pytest tests/ -q`
</verification>

<success_criteria>
- profile_display.py exists with display_profile() function
- tabulate is in pyproject.toml dependencies
- Branded header, sectioned table, field filtering all work
- NO_COLOR mode produces clean output without ANSI codes
- No regressions in existing test suite
</success_criteria>

<output>
After completion, create `.planning/phases/25-profile-preview/25-01-SUMMARY.md`
</output>
