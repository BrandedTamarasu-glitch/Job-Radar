---
phase: 06-core-packaging-infrastructure
plan: 03
type: execute
wave: 3
depends_on: ["06-02"]
files_modified:
  - job-radar.spec
  - job_radar/__main__.py
autonomous: false

must_haves:
  truths:
    - "Executable launches and completes --help in under 10 seconds"
    - "Executable can run a dry-run search with template profile"
    - "Banner displays correctly on launch"
    - "No ModuleNotFoundError when running frozen executable"
    - "Build warnings reviewed and critical hidden imports addressed"
  artifacts:
    - path: "dist/job-radar/job-radar"
      provides: "Working standalone executable"
  key_links:
    - from: "dist/job-radar/job-radar"
      to: "profiles/_template.json"
      via: "bundled datas accessible via sys._MEIPASS"
      pattern: "_template\\.json"
---

<objective>
Verify the built executable works correctly, fix any hidden import or bundling issues discovered during testing, and confirm the build meets all Phase 6 success criteria.

Purpose: PyInstaller builds often succeed but produce broken executables due to missing hidden imports or resource paths. This plan catches and fixes those issues before the phase is marked complete.

Output: Verified working executable, any .spec/.py fixes committed, human confirmation that it works.
</objective>

<execution_context>
@/Users/coryebert/.claude/get-shit-done/workflows/execute-plan.md
@/Users/coryebert/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-core-packaging-infrastructure/06-01-SUMMARY.md
@.planning/phases/06-core-packaging-infrastructure/06-02-SUMMARY.md
@job-radar.spec
@job_radar/__main__.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Automated build verification and fix cycle</name>
  <files>
    job-radar.spec
    job_radar/__main__.py
  </files>
  <action>
Run a systematic verification of the built executable and fix any issues found.

1. **Check build warnings:**
   Look at `build/job-radar/warn-job-radar.txt` for missing module warnings.
   Any module listed there that is a REAL dependency (not optional/unused) needs to be added to hiddenimports in job-radar.spec.

2. **Startup time test:**
   ```bash
   time ./dist/job-radar/job-radar --version
   ```
   Must complete in under 10 seconds (PKG-04). If slow, check for heavy imports.

3. **Full smoke test:**
   ```bash
   ./dist/job-radar/job-radar --help
   ./dist/job-radar/job-radar --version
   ./dist/job-radar/job-radar --profile profiles/_template.json --dry-run
   ```
   Check for:
   - ModuleNotFoundError (missing hidden import -> add to .spec and rebuild)
   - FileNotFoundError (missing bundled resource -> add to datas in .spec and rebuild)
   - SSL errors (certifi not bundled -> check hidden imports)
   - Any traceback at all

4. **Debug imports if needed:**
   If any ModuleNotFoundError occurs, rebuild with debug:
   ```bash
   pyinstaller job-radar.spec --clean --debug=imports
   ```
   Then check the import trace output to identify what's missing.

5. **Fix-and-rebuild loop:**
   If issues found:
   a. Update job-radar.spec hiddenimports or datas as needed
   b. Rebuild: `pyinstaller job-radar.spec --clean`
   c. Re-test: `./dist/job-radar/job-radar --help`
   d. Repeat until clean

6. **Verify bundled resources:**
   ```bash
   ls dist/job-radar/profiles/
   ```
   Should contain _template.json.

7. **Verify existing dev mode still works:**
   ```bash
   python -m pytest tests/
   python -m job_radar --help
   ```
   No regressions in development mode.
  </action>
  <verify>
    `./dist/job-radar/job-radar --version` prints version in under 10 seconds.
    `./dist/job-radar/job-radar --help` shows full help text with no errors.
    `./dist/job-radar/job-radar --profile profiles/_template.json --dry-run` completes with banner and dry-run output.
    `python -m pytest tests/` passes all tests (dev mode preserved).
  </verify>
  <done>
    No ModuleNotFoundError or FileNotFoundError in frozen executable.
    Startup completes in under 10 seconds.
    All three smoke tests (--version, --help, --dry-run) pass.
    Build warnings reviewed and addressed.
    Dev mode tests still pass.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete standalone executable for Job Radar built with PyInstaller in onedir mode.
    The executable should launch with an ASCII art banner, respond to --help and --version,
    and run a dry-run search against the template profile.
  </what-built>
  <how-to-verify>
    1. Open a NEW terminal window (not the one used for building)
    2. Navigate to the project directory
    3. Run: `./dist/job-radar/job-radar --version`
       Expected: Prints "job-radar 1.1.0" quickly (under 10 seconds)
    4. Run: `./dist/job-radar/job-radar --help`
       Expected: Shows CLI help with all flags (--profile, --from, --to, --output, etc.)
    5. Run: `./dist/job-radar/job-radar --profile profiles/_template.json --dry-run`
       Expected: ASCII art "Job Radar" banner appears, then dry-run output listing queries
    6. Verify: No Python tracebacks or error messages appeared
    7. Check file size: `du -sh dist/job-radar/` (should be reasonable, probably 30-80 MB)
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any issues you see.</resume-signal>
</task>

</tasks>

<verification>
1. Executable responds to --version, --help, and --dry-run without errors
2. Startup time under 10 seconds
3. Banner displays correctly
4. No missing module or file errors
5. Dev mode (python -m job_radar, pytest) still works
6. Human confirms executable works in fresh terminal
</verification>

<success_criteria>
All Phase 6 success criteria verified:
1. Executable launches without Python installed (onedir mode, all deps bundled)
2. Startup completes in under 10 seconds
3. Application can access bundled resource files (profiles/_template.json)
4. No hidden import errors
5. Human-verified working
</success_criteria>

<output>
After completion, create `.planning/phases/06-core-packaging-infrastructure/06-03-SUMMARY.md`
</output>
