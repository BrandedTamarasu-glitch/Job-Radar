---
phase: 19-typography-color-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - job_radar/report.py
autonomous: true

must_haves:
  truths:
    - "Report body text uses system-ui font stack, not Bootstrap default"
    - "Score badges use monospace font stack"
    - "Report title is visually larger than section headings, creating newspaper-style hierarchy"
    - "Three-tier semantic color CSS variables are defined in :root"
    - "Dark mode automatically inverts tier colors preserving hue via prefers-color-scheme"
    - "Typography and colors render with zero external file dependencies"
  artifacts:
    - path: "job_radar/report.py"
      provides: "CSS custom properties for fonts, type scale, and 3-tier semantic colors"
      contains: "--font-sans"
    - path: "job_radar/report.py"
      provides: "Dark mode media query with inverted lightness values"
      contains: "prefers-color-scheme: dark"
    - path: "job_radar/report.py"
      provides: "System font stack applied to body"
      contains: "system-ui"
  key_links:
    - from: "CSS :root variables"
      to: "body, h1, h2, h3, .score-badge selectors"
      via: "var() references in CSS rules"
      pattern: "var\\(--font-"
    - from: "Light mode :root"
      to: "Dark mode @media block"
      via: "HSL lightness variable overrides"
      pattern: "--tier-.*-l:"
---

<objective>
Define the CSS variable foundation for typography and semantic colors in the HTML report, and apply system font stacks with newspaper-style type hierarchy.

Purpose: Establish the visual design language that all subsequent v1.4.0 phases build on. CSS custom properties for 3-tier semantic colors (green/cyan/gray) and system font stacks provide the styling infrastructure for cards, table rows, badges, and dark mode — without adding any file size overhead or external dependencies.

Output: Updated `job_radar/report.py` with CSS variables for fonts, type scale, line-heights, and semantic tier colors, plus dark mode inversion via `@media (prefers-color-scheme: dark)`.
</objective>

<execution_context>
@/home/corye/.claude/get-shit-done/workflows/execute-plan.md
@/home/corye/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-typography-color-foundation/19-CONTEXT.md
@.planning/phases/19-typography-color-foundation/19-RESEARCH.md
@job_radar/report.py
@tests/test_report.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define CSS custom properties for typography and semantic colors</name>
  <files>job_radar/report.py</files>
  <action>
In the `_generate_html_report` function's inline `<style>` block, add CSS custom properties in `:root` BEFORE the existing CSS rules. These variables are the foundation for all subsequent styling.

**Font stack variables (per user decision: system-ui for body, monospace for scores ONLY):**
```css
--font-sans: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
--font-mono: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
```

**Typography scale variables (per user decision: newspaper-style hierarchy with larger title, clear sections, smaller body):**
```css
--font-size-title: 2rem;
--font-size-section: 1.5rem;
--font-size-subsection: 1.125rem;
--font-size-body: 1rem;
--font-size-small: 0.875rem;
--line-height-tight: 1.25;
--line-height-normal: 1.5;
--line-height-relaxed: 1.6;
```

**Three-tier semantic color variables using HSL (per user decision: 3 tiers only, warm-to-cool gradient):**

Tier 1 — Strong (score >= 4.0): Green hue (warm, positive)
```css
--tier-strong-h: 142;
--tier-strong-s: 55%;
--tier-strong-l: 93%;
--tier-strong-border-l: 33%;
--tier-strong-text-l: 25%;
--color-tier-strong-bg: hsl(142, 55%, 93%);
--color-tier-strong-border: hsl(142, 55%, 33%);
--color-tier-strong-text: hsl(142, 55%, 25%);
```

Tier 2 — Recommended (score 3.5-3.9): Cyan/teal hue (cool, neutral)
```css
--tier-rec-h: 180;
--tier-rec-s: 50%;
--tier-rec-l: 92%;
--tier-rec-border-l: 28%;
--tier-rec-text-l: 22%;
--color-tier-rec-bg: hsl(180, 50%, 92%);
--color-tier-rec-border: hsl(180, 50%, 28%);
--color-tier-rec-text: hsl(180, 50%, 22%);
```

Tier 3 — Worth Reviewing (score 2.8-3.4): Neutral gray (muted)
```css
--tier-review-h: 210;
--tier-review-s: 10%;
--tier-review-l: 95%;
--tier-review-border-l: 45%;
--tier-review-text-l: 35%;
--color-tier-review-bg: hsl(210, 10%, 95%);
--color-tier-review-border: hsl(210, 10%, 45%);
--color-tier-review-text: hsl(210, 10%, 35%);
```

Note: Use a slight blue-gray (hue 210, low saturation) for the "review" tier rather than pure achromatic gray (0, 0%), to give it a slightly cooler feel that aligns with the warm-to-cool gradient. The 10% saturation is subtle enough to read as "neutral" visually.

**Dark mode overrides in `@media (prefers-color-scheme: dark)` block:**
Override the HSL lightness variables only. Hue and saturation stay the same (per user decision: same hue, inverted contrast). Also set Bootstrap dark theme variables.
```css
@media (prefers-color-scheme: dark) {
  :root {
    --tier-strong-l: 14%;
    --tier-strong-border-l: 52%;
    --tier-strong-text-l: 60%;
    --color-tier-strong-bg: hsl(142, 55%, 14%);
    --color-tier-strong-border: hsl(142, 55%, 52%);
    --color-tier-strong-text: hsl(142, 55%, 60%);

    --tier-rec-l: 12%;
    --tier-rec-border-l: 48%;
    --tier-rec-text-l: 55%;
    --color-tier-rec-bg: hsl(180, 50%, 12%);
    --color-tier-rec-border: hsl(180, 50%, 48%);
    --color-tier-rec-text: hsl(180, 50%, 55%);

    --tier-review-l: 16%;
    --tier-review-border-l: 42%;
    --tier-review-text-l: 50%;
    --color-tier-review-bg: hsl(210, 10%, 16%);
    --color-tier-review-border: hsl(210, 10%, 42%);
    --color-tier-review-text: hsl(210, 10%, 50%);
  }
}
```

IMPORTANT: The existing `[data-bs-theme="dark"]` rule and `@media print` rule must be preserved. Place the new `:root` block at the very start of the `<style>` tag, then the dark mode overrides. Keep all existing CSS rules intact.

Also add `<meta name="color-scheme" content="light dark">` if not already present (it IS already present, so just verify).

IMPORTANT: All CSS is inline in the `<style>` block inside the Python f-string in `_generate_html_report`. Remember to use double curly braces `{{` and `}}` for CSS braces in the f-string.
  </action>
  <verify>
Run: `python -c "from job_radar.report import generate_report; print('import ok')"`

Then generate a test HTML and verify CSS variables are present:
```bash
cd /home/corye/Claude/Job-Radar && python -c "
from pathlib import Path
from job_radar.report import _generate_html_report
from job_radar.sources import JobResult
import tempfile, os

# Minimal test generation
with tempfile.TemporaryDirectory() as d:
    p = Path(d) / 'test.html'
    _generate_html_report(
        p,
        {'name': 'Test', 'target_titles': [], 'core_skills': [], 'level': 'senior',
         'years_experience': 5, 'location': 'Remote', 'arrangement': ['remote']},
        [{'job': JobResult('Title','Co','Loc','remote','100k','2026-01-01','desc','http://x','Src'),
          'score': {'overall': 4.0, 'recommendation': 'Strong',
                    'components': {'skill_match': {'ratio': '1/1', 'matched_core': ['Python'], 'matched_secondary': []},
                                   'title_relevance': {'reason': 'Match'}, 'seniority': {'reason': 'Ok'},
                                   'response': {'likelihood': 'High', 'reason': 'Good'}}},
          'is_new': True}],
        [], ['Src'], '2026-01-01', '2026-01-02')
    html = p.read_text()
    checks = [
        ('--font-sans' in html, '--font-sans variable'),
        ('--font-mono' in html, '--font-mono variable'),
        ('system-ui' in html, 'system-ui font'),
        ('--font-size-title' in html, '--font-size-title variable'),
        ('--tier-strong-h' in html, 'strong tier hue'),
        ('--tier-rec-h' in html, 'recommended tier hue'),
        ('--tier-review-h' in html, 'review tier hue'),
        ('--color-tier-strong-bg' in html, 'strong bg color'),
        ('--color-tier-rec-bg' in html, 'recommended bg color'),
        ('prefers-color-scheme: dark' in html, 'dark mode media query'),
    ]
    for ok, name in checks:
        print(f'{'PASS' if ok else 'FAIL'}: {name}')
    if not all(c[0] for c in checks):
        raise SystemExit(1)
    print('All CSS variable checks passed')
"
```
  </verify>
  <done>
`:root` block contains all font stack, type scale, line-height, and 3-tier semantic color CSS custom properties. Dark mode `@media (prefers-color-scheme: dark)` block overrides lightness values for all three tiers while preserving hue. All existing CSS preserved. Module imports successfully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Apply system font stacks and typography hierarchy to HTML elements</name>
  <files>job_radar/report.py</files>
  <action>
Add CSS rules that consume the custom properties defined in Task 1 to apply typography to the HTML report. All changes are in the `<style>` block of `_generate_html_report`.

**Body font application:**
```css
body {
  font-family: var(--font-sans);
  font-size: var(--font-size-body);
  line-height: var(--line-height-normal);
}
```

**Heading hierarchy (newspaper-style: larger title, clear section differentiation):**
```css
h1, .h1 {
  font-size: var(--font-size-title);
  line-height: var(--line-height-tight);
  font-weight: 700;
  letter-spacing: -0.01em;
}
h2, .h2 {
  font-size: var(--font-size-section);
  line-height: 1.3;
  font-weight: 600;
}
h3, .h3 {
  font-size: var(--font-size-subsection);
  line-height: 1.4;
  font-weight: 600;
}
```

**Score badge monospace (per user decision: monospace for score badges ONLY):**
Update the existing `.score-badge` CSS rule to use the monospace variable:
```css
.score-badge {
  font-family: var(--font-mono);
  font-variant-numeric: tabular-nums;
  font-size: 0.9375rem;
  padding: 0.35em 0.65em;
}
```

**Comfortable spacing (per user decision: more line height and padding for scanning):**
```css
.card-body {
  padding: 1.25rem;
}
.card-body ul {
  line-height: var(--line-height-relaxed);
}
.card-header h3, .card-header .h5 {
  line-height: 1.4;
}
```

**Metadata/small text:**
```css
.text-small, small, .metadata {
  font-size: var(--font-size-small);
  line-height: var(--line-height-normal);
}
```

Also update the `<h1>` tag in the `_generate_html_report` function's HTML body. The report title `<h1>` should use `class="mb-3"` (already does). No HTML structural changes needed beyond existing markup — the CSS rules will cascade.

Verify that the body font-family rule does NOT override Bootstrap's base styles in a way that breaks other components. Since we're setting `font-family` on `body`, Bootstrap components inherit from body which is correct.

IMPORTANT: Keep all existing CSS rules (print, dark mode, score-badge, copy-btn, focus indicators, shortcut-hint, status styles, WCAG overrides). The new typography rules supplement them. If there's a conflict (e.g., existing `.score-badge` rule), update the existing rule rather than adding a duplicate.
  </action>
  <verify>
Run existing tests to ensure no regressions:
```bash
cd /home/corye/Claude/Job-Radar && python -m pytest tests/test_report.py -v --tb=short
```

Then verify typography CSS is applied:
```bash
cd /home/corye/Claude/Job-Radar && python -c "
from pathlib import Path
from job_radar.report import _generate_html_report
from job_radar.sources import JobResult
import tempfile

with tempfile.TemporaryDirectory() as d:
    p = Path(d) / 'test.html'
    _generate_html_report(
        p,
        {'name': 'Test', 'target_titles': [], 'core_skills': [], 'level': 'senior',
         'years_experience': 5, 'location': 'Remote', 'arrangement': ['remote']},
        [{'job': JobResult('Title','Co','Loc','remote','100k','2026-01-01','desc','http://x','Src'),
          'score': {'overall': 4.0, 'recommendation': 'Strong',
                    'components': {'skill_match': {'ratio': '1/1', 'matched_core': ['Python'], 'matched_secondary': []},
                                   'title_relevance': {'reason': 'Match'}, 'seniority': {'reason': 'Ok'},
                                   'response': {'likelihood': 'High', 'reason': 'Good'}}},
          'is_new': True}],
        [], ['Src'], '2026-01-01', '2026-01-02')
    html = p.read_text()
    checks = [
        ('font-family: var(--font-sans)' in html, 'body uses font-sans variable'),
        ('font-family: var(--font-mono)' in html, 'score-badge uses font-mono variable'),
        ('font-size: var(--font-size-title)' in html, 'h1 uses title size variable'),
        ('font-size: var(--font-size-section)' in html, 'h2 uses section size variable'),
        ('font-variant-numeric: tabular-nums' in html, 'tabular-nums for score alignment'),
        ('line-height: var(--line-height-normal)' in html, 'body line-height from variable'),
        ('font-weight: 700' in html or 'font-weight: 600' in html, 'heading font weights set'),
    ]
    for ok, name in checks:
        print(f'{'PASS' if ok else 'FAIL'}: {name}')
    if not all(c[0] for c in checks):
        raise SystemExit(1)
    print('All typography checks passed')
"
```
  </verify>
  <done>
Body text uses system-ui font stack via CSS variable. Score badges use monospace font stack via CSS variable. Type hierarchy creates clear visual differentiation: title (2rem/700), section headings (1.5rem/600), subsections (1.125rem/600), body (1rem), small text (0.875rem). Line heights use unitless values. All existing tests pass. No external font files loaded.
  </done>
</task>

</tasks>

<verification>
1. `python -m pytest tests/test_report.py -v` — all existing tests pass (no regressions)
2. Generated HTML contains `:root` block with `--font-sans`, `--font-mono`, `--font-size-*`, `--line-height-*`, `--tier-strong-*`, `--tier-rec-*`, `--tier-review-*` CSS custom properties
3. Generated HTML contains `@media (prefers-color-scheme: dark)` block with inverted lightness values
4. Body element inherits `system-ui` font stack
5. Score badges use monospace font stack
6. No external font file references (zero overhead)
7. `python -c "from job_radar.report import generate_report"` succeeds without errors
</verification>

<success_criteria>
- CSS custom properties for 3-tier semantic colors defined in :root (green/cyan/gray-blue HSL values)
- Dark mode media query inverts lightness while preserving hue for all 3 tiers
- System font stacks applied: sans-serif body, monospace scores
- Typography hierarchy: title > section > subsection > body > small with distinct font sizes and weights
- Comfortable spacing via unitless line-heights (1.25, 1.5, 1.6)
- Zero external dependencies added
- All existing test_report.py tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/19-typography-color-foundation/19-01-SUMMARY.md`
</output>
