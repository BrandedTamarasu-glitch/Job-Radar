---
phase: 19-typography-color-foundation
plan: 02
type: execute
wave: 2
depends_on: ["19-01"]
files_modified:
  - job_radar/report.py
  - tests/test_report.py
autonomous: false

must_haves:
  truths:
    - "Job cards with score >= 4.0 show green pastel background with green left border"
    - "Job cards with score 3.5-3.9 show cyan pastel background with cyan left border"
    - "Job cards with score 2.8-3.4 show gray pastel background with gray left border"
    - "Table rows show left border color matching their score tier"
    - "Score badges are pill-shaped with tier-specific background colors"
    - "Same pill badge style in both cards and table"
    - "Application status badges (Applied, Interviewing, etc.) use pill style"
    - "Non-color indicators distinguish tiers for colorblind users"
    - "Dark mode automatically adjusts all tier colors"
  artifacts:
    - path: "job_radar/report.py"
      provides: "Tier CSS classes for cards, table rows, and badges"
      contains: "tier-strong"
    - path: "job_radar/report.py"
      provides: "Pill badge CSS with tier-specific colors"
      contains: "rounded-pill"
    - path: "job_radar/report.py"
      provides: "Non-color indicators via border thickness and Unicode icons"
      contains: "border-left"
    - path: "job_radar/report.py"
      provides: "Python tier classification logic for score -> CSS class mapping"
      contains: "tier-strong"
    - path: "tests/test_report.py"
      provides: "Tests for tier classes, pill badges, and non-color indicators"
      contains: "tier-strong"
  key_links:
    - from: "Score value in Python"
      to: "tier-strong/tier-rec/tier-review CSS class"
      via: "Conditional in _html_recommended_section and _html_results_table"
      pattern: "tier-(strong|rec|review)"
    - from: "Tier CSS classes on elements"
      to: "CSS custom properties"
      via: "var(--color-tier-*) in .tier-strong, .tier-rec, .tier-review rules"
      pattern: "var\\(--color-tier-"
    - from: "Light mode tier colors"
      to: "Dark mode tier colors"
      via: "prefers-color-scheme overrides lightness variables"
      pattern: "prefers-color-scheme: dark"
---

<objective>
Apply the semantic color system to job cards, table rows, and score badges. Convert badges to pill style. Add non-color indicators for colorblind accessibility. Update tests for new visual elements.

Purpose: Make the report visually scannable by encoding score tiers into colors, borders, and badge styles — achieving the "newspaper-style scanning" the user requested. Users can immediately distinguish strong matches (green), recommended matches (cyan), and worth-reviewing matches (gray) without reading numbers. Non-color indicators ensure colorblind users get equivalent information.

Output: Updated `job_radar/report.py` with tier classes on cards/rows, pill-shaped score badges, non-color indicators, and status badge refresh. Updated `tests/test_report.py` with assertions for new visual elements.
</objective>

<execution_context>
@/home/corye/.claude/get-shit-done/workflows/execute-plan.md
@/home/corye/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-typography-color-foundation/19-CONTEXT.md
@.planning/phases/19-typography-color-foundation/19-RESEARCH.md
@.planning/phases/19-typography-color-foundation/19-01-SUMMARY.md
@job_radar/report.py
@tests/test_report.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Apply tier classes to cards and table rows, style pill badges and non-color indicators</name>
  <files>job_radar/report.py</files>
  <action>
This task has two parts: CSS rules for tier styling, and Python logic changes to assign tier classes.

**Part A: Add tier CSS rules to the `<style>` block**

Add these rules AFTER the typography rules from Plan 01:

Card tier styling (per user decision: subtle pastel backgrounds with colored left border, GitHub issue label style):
```css
/* Tier card backgrounds with left border accent */
.tier-strong {
  background-color: var(--color-tier-strong-bg) !important;
  border-left: 5px solid var(--color-tier-strong-border);
}
.tier-rec {
  background-color: var(--color-tier-rec-bg) !important;
  border-left: 4px solid var(--color-tier-rec-border);
}
.tier-review {
  background-color: var(--color-tier-review-bg) !important;
  border-left: 3px solid var(--color-tier-review-border);
}
```

Note: Border thickness varies by tier (5px/4px/3px) — this is a non-color indicator for colorblind users per WCAG SC 1.4.1.

Table row tier styling (left border indicator for density, per Claude's discretion: border-only in table to avoid visual clutter with striped rows):
```css
/* Table row tier indicators */
table tr.tier-strong {
  border-left: 5px solid var(--color-tier-strong-border);
}
table tr.tier-rec {
  border-left: 4px solid var(--color-tier-rec-border);
}
table tr.tier-review {
  border-left: 3px solid var(--color-tier-review-border);
}
```

Pill badge styling (per user decision: pill-shaped like GitHub labels, same in cards and table):
```css
/* Pill score badges with tier colors */
.tier-badge-strong {
  background-color: var(--color-tier-strong-border) !important;
  color: #fff !important;
}
.tier-badge-rec {
  background-color: var(--color-tier-rec-border) !important;
  color: #fff !important;
}
.tier-badge-review {
  background-color: var(--color-tier-review-border) !important;
  color: #fff !important;
}

/* Dark mode badge text adjustments */
@media (prefers-color-scheme: dark) {
  .tier-badge-strong,
  .tier-badge-rec,
  .tier-badge-review {
    color: #fff !important;
  }
}

/* Pill shape for all score and status badges */
.badge.rounded-pill {
  border-radius: 999em;
  padding: 0.35em 0.65em;
  font-weight: 500;
}

/* Score badge specific: monospace + pill */
.score-badge {
  font-family: var(--font-mono);
  font-variant-numeric: tabular-nums;
  font-size: 0.9375rem;
  border-radius: 999em;
  padding: 0.35em 0.65em;
}
```

Non-color Unicode icon indicators (per Claude's discretion: use both border thickness variation AND Unicode icons for maximum colorblind accessibility):
```css
/* Non-color tier icons for colorblind accessibility */
.tier-icon::before {
  margin-right: 0.25em;
  font-weight: bold;
}
.tier-icon-strong::before {
  content: "\2605 ";
}
.tier-icon-rec::before {
  content: "\2713 ";
}
.tier-icon-review::before {
  content: "\25C6 ";
}
```

Application status badge refresh to pill style (per user decision: status badges also get pill style):
```css
/* Status badges inherit pill style */
.status-badge {
  margin-right: 0.5rem;
  border-radius: 999em;
  padding: 0.35em 0.65em;
  font-size: 0.75rem;
}
```

NEW badge refresh to pill style (per Claude's discretion: YES, refresh for design coherence since all other badges are pills):
```css
/* NEW badge refresh to pill style */
.badge.bg-primary {
  border-radius: 999em;
  padding: 0.35em 0.65em;
}
```

**Part B: Python logic changes to assign tier classes**

Create a helper function at module level (before `_generate_html_report`):
```python
def _score_tier(score: float) -> str:
    """Return CSS tier class suffix based on score value."""
    if score >= 4.0:
        return "strong"
    elif score >= 3.5:
        return "rec"
    else:
        return "review"
```

Also create a helper for tier icon class:
```python
def _tier_icon_class(tier: str) -> str:
    """Return CSS class for tier Unicode icon indicator."""
    return f"tier-icon tier-icon-{tier}"
```

In `_html_recommended_section`:
1. Replace the current `badge_class` logic (bg-success/bg-warning/bg-secondary) with tier-based classes.
2. Change the score badge HTML to use `rounded-pill` + tier badge class:
   - `<span class="badge rounded-pill score-badge tier-badge-{tier}"><span class="visually-hidden">Score </span>{score_val:.1f}<span class="visually-hidden"> out of 5.0</span></span>`
3. Add the tier class to the card's outer `<div>`:
   - The `data_attrs` line that sets `class="card mb-3 job-item"` should become `class="card mb-3 job-item tier-{tier}"`
   - And for cards without URL: `class="card mb-3 tier-{tier}"`
4. Add a tier icon span before the score badge in the card header h3:
   - `<span class="{_tier_icon_class(tier)}" aria-hidden="true"></span>` right before or inside the score badge

In `_html_results_table`:
1. Replace the current `badge_class` logic with tier-based classes.
2. Change score badge to pill: `<span class="badge rounded-pill score-badge tier-badge-{tier}"><span class="visually-hidden">Score </span>{score:.1f}<span class="visually-hidden"> out of 5.0</span></span>`
3. Add tier class to `<tr>` tag: `<tr class="job-item tier-{tier}"` (merge with existing `class="job-item"`)
   - For rows without URL: `<tr class="tier-{tier}"`
4. Add tier icon span in the score cell (before or after the score badge, inside the `<td>`).

IMPORTANT: Preserve ALL existing accessibility features:
- Keep `visually-hidden` spans on score and NEW badges
- Keep `aria-label` on links
- Keep `data-job-url`, `data-score`, `data-job-key`, `data-job-title`, `data-job-company` attributes
- Keep `tabindex="0"` on interactive items
- Keep `scope="row"` on first column
- Keep the `<caption>` on the table
- The tier icon spans should have `aria-hidden="true"` since the score value already has screen reader text

Also update the JavaScript `STATUS_CONFIG` object: change the `class` values to include `rounded-pill` so dynamically rendered status badges are also pill-shaped:
```javascript
var STATUS_CONFIG = {
  applied:      { class: 'bg-success rounded-pill', label: 'Applied' },
  interviewing: { class: 'bg-primary rounded-pill', label: 'Interviewing' },
  rejected:     { class: 'bg-danger rounded-pill',  label: 'Rejected' },
  offer:        { class: 'bg-warning text-dark rounded-pill', label: 'Offer' }
};
```

And update the `renderStatusBadge` function: when creating the badge element, add `status-badge` class (already does this). The `rounded-pill` from STATUS_CONFIG.class will handle pill shape.

IMPORTANT: Remember Python f-string escaping — use `{{` and `}}` for literal CSS/JS braces.
  </action>
  <verify>
Run existing tests first:
```bash
cd /home/corye/Claude/Job-Radar && python -m pytest tests/test_report.py -v --tb=short
```

Then verify tier classes and pill badges are present:
```bash
cd /home/corye/Claude/Job-Radar && python -c "
from pathlib import Path
from job_radar.report import _generate_html_report
from job_radar.sources import JobResult
import tempfile

with tempfile.TemporaryDirectory() as d:
    p = Path(d) / 'test.html'
    _generate_html_report(
        p,
        {'name': 'Test', 'target_titles': [], 'core_skills': [], 'level': 'senior',
         'years_experience': 5, 'location': 'Remote', 'arrangement': ['remote']},
        [
         {'job': JobResult('StrongJob','Co','Loc','remote','100k','2026-01-01','desc','http://x','Src'),
          'score': {'overall': 4.2, 'recommendation': 'Strong',
                    'components': {'skill_match': {'ratio': '1/1', 'matched_core': ['Py'], 'matched_secondary': []},
                                   'title_relevance': {'reason': 'M'}, 'seniority': {'reason': 'Ok'},
                                   'response': {'likelihood': 'High', 'reason': 'Good'}}},
          'is_new': True},
         {'job': JobResult('RecJob','Co2','Loc','remote','100k','2026-01-01','desc','http://y','Src'),
          'score': {'overall': 3.7, 'recommendation': 'Good',
                    'components': {'skill_match': {'ratio': '1/1', 'matched_core': ['Py'], 'matched_secondary': []},
                                   'title_relevance': {'reason': 'M'}, 'seniority': {'reason': 'Ok'},
                                   'response': {'likelihood': 'Med', 'reason': 'Ok'}}},
          'is_new': False},
         {'job': JobResult('ReviewJob','Co3','Loc','remote','100k','2026-01-01','desc','http://z','Src'),
          'score': {'overall': 3.0, 'recommendation': 'Review',
                    'components': {'skill_match': {'ratio': '1/1', 'matched_core': ['Py'], 'matched_secondary': []},
                                   'title_relevance': {'reason': 'M'}, 'seniority': {'reason': 'Ok'},
                                   'response': {'likelihood': 'Low', 'reason': 'Ok'}}},
          'is_new': True},
        ],
        [], ['Src'], '2026-01-01', '2026-01-02')
    html = p.read_text()
    checks = [
        ('tier-strong' in html, 'tier-strong class applied'),
        ('tier-rec' in html, 'tier-rec class applied'),
        ('tier-review' in html, 'tier-review class applied'),
        ('tier-badge-strong' in html, 'tier badge strong class'),
        ('tier-badge-rec' in html, 'tier badge rec class'),
        ('tier-badge-review' in html, 'tier badge review class'),
        ('rounded-pill' in html, 'rounded-pill class on badges'),
        ('border-left: 5px' in html, '5px border for strong tier'),
        ('border-left: 4px' in html, '4px border for rec tier'),
        ('border-left: 3px' in html, '3px border for review tier'),
        ('tier-icon' in html, 'tier icon class present'),
        ('aria-hidden=\"true\"' in html, 'tier icons have aria-hidden'),
        ('bg-success rounded-pill' in html, 'status badge pill style'),
        ('visually-hidden' in html, 'screen reader text preserved'),
        ('scope=\"row\"' in html, 'table scope attributes preserved'),
    ]
    for ok, name in checks:
        print(f'{'PASS' if ok else 'FAIL'}: {name}')
    if not all(c[0] for c in checks):
        raise SystemExit(1)
    print('All tier styling checks passed')
"
```
  </verify>
  <done>
Cards display tier-specific pastel backgrounds with colored left borders (5px green / 4px cyan / 3px gray). Table rows have left border tier indicators. Score badges are pill-shaped with tier-specific background colors. Non-color indicators include both border thickness variation and Unicode icons (star/check/diamond). Status badges refreshed to pill style. NEW badge refreshed to pill style. All existing accessibility features preserved. All existing tests pass.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add tests for tier classes, pill badges, and non-color indicators</name>
  <files>tests/test_report.py</files>
  <action>
Add test functions to `tests/test_report.py` that verify the new Phase 19 visual elements. Place them after the existing WCAG tests section, with a new section header comment.

Add the following tests:

```python
# -- Phase 19: Typography & Color Foundation Tests --------------------------------

def test_html_report_system_font_stack(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test that HTML report uses system font stack CSS variable."""
    result = generate_report(...)  # standard fixture call
    html_content = Path(result["html"]).read_text()
    assert "--font-sans" in html_content, "System font stack variable missing"
    assert "system-ui" in html_content, "system-ui font not in stack"
    assert "font-family: var(--font-sans)" in html_content, "Body not using font-sans variable"

def test_html_report_monospace_score_badges(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test that score badges use monospace font stack."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    assert "--font-mono" in html_content, "Monospace font variable missing"
    assert "ui-monospace" in html_content, "ui-monospace not in stack"

def test_html_report_typography_hierarchy(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test newspaper-style type hierarchy with distinct heading sizes."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    assert "--font-size-title" in html_content, "Title size variable missing"
    assert "--font-size-section" in html_content, "Section size variable missing"
    assert "--font-size-body" in html_content, "Body size variable missing"

def test_html_report_semantic_color_variables(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test that 3-tier semantic color CSS variables are defined."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    # Green tier (strong, >= 4.0)
    assert "--color-tier-strong-bg" in html_content, "Strong tier background color missing"
    assert "--color-tier-strong-border" in html_content, "Strong tier border color missing"
    # Cyan tier (recommended, 3.5-3.9)
    assert "--color-tier-rec-bg" in html_content, "Recommended tier background color missing"
    assert "--color-tier-rec-border" in html_content, "Recommended tier border color missing"
    # Gray tier (review, 2.8-3.4)
    assert "--color-tier-review-bg" in html_content, "Review tier background color missing"
    assert "--color-tier-review-border" in html_content, "Review tier border color missing"

def test_html_report_dark_mode_color_inversion(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test that dark mode inverts tier color lightness via media query."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    assert "prefers-color-scheme: dark" in html_content, "Dark mode media query missing"
    # Verify dark mode overrides lightness (should have multiple prefers-color-scheme blocks)
    dark_mode_count = html_content.count("prefers-color-scheme: dark")
    assert dark_mode_count >= 1, "Dark mode media query should appear at least once"

def test_html_report_tier_classes_on_cards(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test that job cards have tier-specific CSS classes based on score."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    # First result has score 4.2 (strong tier)
    assert "tier-strong" in html_content, "Strong tier class missing on card"
    # Second result has score 3.7 (recommended tier)
    assert "tier-rec" in html_content, "Recommended tier class missing on card"

def test_html_report_tier_classes_on_table_rows(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test that table rows have tier-specific CSS classes."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    # Check that tr elements contain tier classes
    # Third result has score 2.8 (review tier)
    assert "tier-review" in html_content, "Review tier class missing on table row"

def test_html_report_pill_shaped_score_badges(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test that score badges use pill shape with tier colors."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    assert "rounded-pill" in html_content, "Pill shape class missing"
    assert "tier-badge-strong" in html_content, "Strong tier badge class missing"
    # Pill CSS rule
    assert "border-radius: 999em" in html_content, "Pill border-radius CSS rule missing"

def test_html_report_non_color_indicators(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test non-color indicators for colorblind accessibility (border thickness + icons)."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    # Border thickness variation in CSS
    assert "border-left: 5px" in html_content, "5px border for strong tier missing"
    assert "border-left: 4px" in html_content, "4px border for recommended tier missing"
    assert "border-left: 3px" in html_content, "3px border for review tier missing"
    # Icon indicators
    assert "tier-icon" in html_content, "Tier icon class missing"

def test_html_report_status_badges_pill_style(sample_profile, sample_scored_results, sample_manual_urls, tmp_path):
    """Test that application status badges use pill style."""
    result = generate_report(...)
    html_content = Path(result["html"]).read_text()
    # STATUS_CONFIG should include rounded-pill in class
    assert "bg-success rounded-pill" in html_content or "rounded-pill" in html_content, \
        "Status badges should use pill style"
```

Each test should use the standard fixture pattern from existing tests:
```python
result = generate_report(
    profile=sample_profile,
    scored_results=sample_scored_results,
    manual_urls=sample_manual_urls,
    sources_searched=["Dice"],
    from_date="2026-02-06",
    to_date="2026-02-09",
    output_dir=str(tmp_path),
)
```

IMPORTANT: The existing `sample_scored_results` fixture has 3 results: score 4.2 (strong), 3.7 (recommended), 2.8 (review) — perfect for testing all 3 tiers. No new fixtures needed.
  </action>
  <verify>
Run the full test suite including new tests:
```bash
cd /home/corye/Claude/Job-Radar && python -m pytest tests/test_report.py -v --tb=short
```

All tests should pass, including both existing and new Phase 19 tests. Count the new tests to confirm they were added:
```bash
cd /home/corye/Claude/Job-Radar && python -m pytest tests/test_report.py -v --tb=short -k "tier or typography or font or pill or non_color or dark_mode_color"
```
  </verify>
  <done>
At least 10 new tests added covering: system font stack, monospace score badges, typography hierarchy, semantic color variables, dark mode color inversion, tier classes on cards, tier classes on table rows, pill-shaped badges, non-color indicators, and status badge pill style. All new and existing tests pass.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Visual verification of typography and color system</name>
  <what-built>
Complete typography and semantic color foundation for HTML reports:
- System font stacks (sans-serif body, monospace scores)
- Newspaper-style type hierarchy (2rem title, 1.5rem sections, 1rem body)
- 3-tier semantic colors: green (strong >= 4.0), cyan (recommended 3.5-3.9), gray (review 2.8-3.4)
- Pill-shaped score badges with tier colors
- Pill-shaped status badges (Applied, Interviewing, etc.)
- Colored left borders with thickness variation (5px/4px/3px) for colorblind accessibility
- Unicode tier icons (star/check/diamond) for additional non-color indicators
- Dark mode with same hues, inverted lightness
  </what-built>
  <how-to-verify>
1. Generate a test report:
   ```bash
   cd /home/corye/Claude/Job-Radar && python -m job_radar --profile profiles/your_profile.json
   ```
   Or use the most recent report in `results/`.

2. Open the generated HTML file in a browser. Check LIGHT MODE:
   - Report title should be noticeably larger than section headings
   - Body text should use your OS system font (SF Pro on macOS, Segoe UI on Windows, etc.)
   - Score badges should be pill-shaped (fully rounded) with monospace numbers
   - Cards with score >= 4.0 should have light green background + green left border
   - Cards with score 3.5-3.9 should have light cyan background + cyan left border
   - Cards with score < 3.5 should have light gray background + gray left border
   - Table rows should have left border color matching their tier
   - Star/check/diamond icons should appear near score badges
   - Status dropdown badges should also be pill-shaped

3. Check DARK MODE (toggle OS dark mode setting):
   - Same hue per tier, but inverted: dark backgrounds with lighter borders
   - Green/cyan/gray tints should still be distinguishable
   - Text should be readable against dark tier backgrounds
   - Badges should maintain readability

4. Verify NO EXTERNAL FILES loaded:
   - Open browser DevTools Network tab, reload page
   - No font file requests (woff, woff2, ttf, otf)
   - Only existing CDN requests (Bootstrap CSS/JS, Notyf, Prism)
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues with colors, typography, badges, or dark mode.</resume-signal>
</task>

</tasks>

<verification>
1. `python -m pytest tests/test_report.py -v` — all tests pass (existing + new Phase 19 tests)
2. Generated HTML has tier classes on cards (tier-strong, tier-rec, tier-review) with correct score mapping
3. Generated HTML has tier classes on table rows
4. Score badges use `rounded-pill` + `tier-badge-{tier}` classes (pill shape + tier color)
5. CSS includes border-left rules with varying thickness (5px/4px/3px)
6. CSS includes tier icon rules with Unicode characters
7. Status badges include `rounded-pill` in their STATUS_CONFIG classes
8. All WCAG accessibility features preserved (screen reader text, ARIA landmarks, focus indicators)
9. Dark mode adjusts all tier colors via prefers-color-scheme media query
10. Human verification confirms visual design matches intent
</verification>

<success_criteria>
- Job cards display tier-appropriate pastel backgrounds with colored left borders
- Table rows display tier-appropriate left border indicators
- Score badges are pill-shaped with tier-specific colors, consistent in cards and table
- Application status badges refreshed to pill style
- Non-color indicators present: border thickness variation (5px/4px/3px) AND Unicode tier icons
- Dark mode preserves tier hues with inverted lightness
- All existing WCAG accessibility features intact
- At least 10 new tests pass covering all visual elements
- Human confirms visual output matches design intent
</success_criteria>

<output>
After completion, create `.planning/phases/19-typography-color-foundation/19-02-SUMMARY.md`
</output>
