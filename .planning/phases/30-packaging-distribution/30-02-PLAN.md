---
phase: 30-packaging-distribution
plan: 02
type: execute
wave: 2
depends_on: ["30-01"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "PyInstaller build completes without errors on the local machine"
    - "CustomTkinter theme JSON files and OTF fonts are present in the build output"
    - "Both CLI and GUI executables exist in the dist directory"
    - "CLI executable responds to --version flag correctly"
    - "GUI executable launches without console window"
  artifacts:
    - path: "dist/job-radar/job-radar"
      provides: "CLI executable with console"
    - path: "dist/job-radar/job-radar-gui"
      provides: "GUI executable without console"
    - path: "dist/job-radar/customtkinter/assets/themes/"
      provides: "CustomTkinter theme JSON files"
      contains: "blue.json"
    - path: "dist/job-radar/customtkinter/assets/fonts/"
      provides: "CustomTkinter shape font"
      contains: "CustomTkinter_shapes_font.otf"
  key_links:
    - from: "dist/job-radar/job-radar"
      to: "job_radar/__main__.py"
      via: "PyInstaller frozen entry point"
      pattern: "frozen"
    - from: "dist/job-radar/customtkinter/assets/"
      to: "customtkinter library install"
      via: "spec file datas parameter"
      pattern: "added_files"
---

<objective>
Build executables locally, verify CustomTkinter asset bundling, and confirm with human verification

Purpose: Validate that the PyInstaller build configuration actually produces working executables with all GUI assets correctly bundled. This is the critical verification step - executables may work on dev machines but fail in production if assets are missing.

Output: Verified local build with confirmed asset bundling, human sign-off on executable quality
</objective>

<execution_context>
@/home/corye/.claude/get-shit-done/workflows/execute-plan.md
@/home/corye/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-packaging-distribution/30-RESEARCH.md
@.planning/phases/30-packaging-distribution/30-01-SUMMARY.md
@job-radar.spec
@job_radar/__main__.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run PyInstaller build and verify output structure</name>
  <files></files>
  <action>
1. Clean any previous build artifacts:
   ```bash
   rm -rf dist/ build/
   ```

2. Run PyInstaller build:
   ```bash
   pyinstaller job-radar.spec --clean
   ```
   This should produce `dist/job-radar/` directory with both executables.

3. Verify the build output structure:
   - `dist/job-radar/job-radar` (or `.exe` on Windows) exists — CLI executable
   - `dist/job-radar/job-radar-gui` (or `.exe` on Windows) exists — GUI executable
   - `dist/job-radar/customtkinter/assets/themes/` contains JSON files (blue.json, dark-blue.json, green.json)
   - `dist/job-radar/customtkinter/assets/fonts/` contains `CustomTkinter_shapes_font.otf`
   - `dist/job-radar/profiles/_template.json` exists (profile template)

4. Run CLI smoke test:
   ```bash
   dist/job-radar/job-radar --version
   ```
   Should print version without errors.

5. If on Linux, check that the GUI executable is not marked as a console app:
   ```bash
   file dist/job-radar/job-radar-gui
   ```

6. List the CustomTkinter assets for verification:
   ```bash
   find dist/job-radar/customtkinter -type f | sort
   ```

If the build fails:
- Check error output for missing hidden imports and add them to spec file
- Check for CustomTkinter asset path issues (import path vs bundled path mismatch)
- Resolve and re-run build

If assets are missing:
- Verify customtkinter is installed: `python -c "import customtkinter; print(customtkinter.__file__)"`
- Check that the spec file datas logic runs correctly
- Fix the datas collection in spec file if needed
  </action>
  <verify>
```bash
# Verify both executables exist
test -f dist/job-radar/job-radar && echo "CLI: OK" || echo "CLI: MISSING"
test -f dist/job-radar/job-radar-gui && echo "GUI: OK" || echo "GUI: MISSING"

# Verify CustomTkinter assets
test -d dist/job-radar/customtkinter/assets/themes && echo "Themes: OK" || echo "Themes: MISSING"
test -d dist/job-radar/customtkinter/assets/fonts && echo "Fonts: OK" || echo "Fonts: MISSING"

# Verify CLI works
dist/job-radar/job-radar --version

# Count theme files (should be >= 3)
ls dist/job-radar/customtkinter/assets/themes/*.json | wc -l
```
  </verify>
  <done>PyInstaller build completes successfully. Both job-radar (CLI) and job-radar-gui (GUI) executables exist. CustomTkinter themes (JSON) and fonts (OTF) are present in dist/job-radar/customtkinter/assets/. CLI --version smoke test passes.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Human verification of executable functionality</name>
  <files>dist/job-radar/job-radar, dist/job-radar/job-radar-gui</files>
  <action>
Human verifies the built executables work correctly.

What was built: PyInstaller build with dual executables (CLI + GUI) and bundled CustomTkinter assets:
- `dist/job-radar/job-radar` — CLI executable (shows console)
- `dist/job-radar/job-radar-gui` — GUI executable (no console window)
- CustomTkinter theme files and fonts bundled in dist directory
- entitlements.plist for macOS code signing
- Updated CI workflow with smoke tests

How to verify:

**Step 1: Test GUI executable**
1. Run `dist/job-radar/job-radar-gui` (or double-click on Windows/macOS)
2. Verify: Desktop window appears with CustomTkinter styling (not default Tkinter gray)
3. Verify: No console window appears alongside the GUI (Windows especially)
4. Verify: Theme renders correctly (rounded buttons, modern widgets, proper colors)
5. Try navigating between tabs (Profile, Search) to confirm widgets render

**Step 2: Test CLI executable**
1. Run `dist/job-radar/job-radar --help` in a terminal
2. Verify: Help text displays correctly with all flags
3. Run `dist/job-radar/job-radar --version`
4. Verify: Version number is printed

**Step 3: Verify on clean-ish environment (optional but recommended)**
- Test from a different user account or directory
- Or note any issues to investigate before tagging a release

**Expected behavior:**
- GUI window: 700x500, CustomTkinter modern theme, tabs for Profile and Search
- CLI: Full help output, version display, no import errors
- No Python installation warnings or missing module errors
  </action>
  <verify>Type "approved" if both executables work correctly, or describe any issues found</verify>
  <done>Human confirms GUI executable launches with proper CustomTkinter styling (no console window) and CLI executable responds to --help and --version correctly.</done>
</task>

</tasks>

<verification>
1. PyInstaller build completes without errors
2. Both executables (CLI and GUI) exist in dist/job-radar/
3. CustomTkinter assets (themes/*.json, fonts/*.otf) are bundled
4. CLI --version smoke test passes
5. Human confirms GUI launches with proper CustomTkinter styling
6. Human confirms no console window on GUI launch
</verification>

<success_criteria>
- Local PyInstaller build succeeds
- Dual executables verified (CLI with console, GUI without console)
- CustomTkinter theme files and fonts confirmed bundled
- Human approves GUI visual quality and CLI functionality
</success_criteria>

<output>
After completion, create `.planning/phases/30-packaging-distribution/30-02-SUMMARY.md`
</output>
